FROM alpine:3.21

RUN apk add --no-cache wget git libtool m4 autoconf automake pkg-config gcc g++ make libfuse-dev libcurl-dev libxml2-dev mime-support

ENV LXCFS_VERSION=4.0.12
RUN wget https://github.com/lxc/lxcfs/archive/lxcfs-$LXCFS_VERSION.tar.gz && \
    mkdir /lxcfs && tar xzvf lxcfs-$LXCFS_VERSION.tar.gz -C /lxcfs --strip-components=1 && \
    cd /lxcfs  && ./bootstrap.sh && ./configure && make

COPY ./hack/build/start.sh /
CMD ["/start.sh"]
